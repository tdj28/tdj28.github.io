<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="A look at how Bayesian statistics can help us understand ways to make decisions (in the context of COVID-19 rapid test accuracy). This post will introduce concepts related to Bayesian statistics, but may still be interesting to individuals already familiar with the topic."><title>Bayesian look at rapid tests</title>
<link rel=canonical href=https://tdj28.github.io/p/bayesian-look-at-rapid-tests/><link rel=stylesheet href=/scss/style.min.a8973e64013f393b33658832ff110095f30eb03e142d9ad3540bb8edbbed8261.css><meta property='og:title' content="Bayesian look at rapid tests"><meta property='og:description' content="A look at how Bayesian statistics can help us understand ways to make decisions (in the context of COVID-19 rapid test accuracy). This post will introduce concepts related to Bayesian statistics, but may still be interesting to individuals already familiar with the topic."><meta property='og:url' content='https://tdj28.github.io/p/bayesian-look-at-rapid-tests/'><meta property='og:site_name' content><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='math'><meta property='article:tag' content='statistics'><meta property='article:tag' content='Bayesian'><meta property='article:published_time' content='2024-08-02T15:21:05-07:00'><meta property='article:modified_time' content='2024-08-02T15:21:05-07:00'><meta name=twitter:title content="Bayesian look at rapid tests"><meta name=twitter:description content="A look at how Bayesian statistics can help us understand ways to make decisions (in the context of COVID-19 rapid test accuracy). This post will introduce concepts related to Bayesian statistics, but may still be interesting to individuals already familiar with the topic."><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky compact"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu15237315471355360968.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>TJ</span></figure><div class=site-meta><h1 class=site-name><a href=/></a></h1><h2 class=site-description></h2></div></header><ol class=menu-social><li><a href=https://github.com/tdj28 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/tdj11100 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span></span></li></ol><ol class=menu id=main-menu></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon id=toc-toggle><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-notes"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 3m0 2a2 2 0 012-2h10a2 2 0 012 2v14a2 2 0 01-2 2H7a2 2 0 01-2-2z"/><path d="M9 7h6"/><path d="M9 11h6"/><path d="M9 15h4"/></svg></div><h2 class="widget-title section-title"></h2><div class=widget--toc id=toc-content><nav id=TableOfContents><ol><li><a href=#person-x>Person X</a></li><li><a href=#definitions-and-grounding-in-reference>Definitions and grounding in reference</a><ol><li><a href=#definitions>Definitions</a><ol><li><a href=#test-results>Test results</a></li><li><a href=#conditional-probability>Conditional Probability</a></li><li><a href=#sensitivity-specificity-and-accuracy>Sensitivity, Specificity, and Accuracy</a></li></ol></li><li><a href=#analysis-of-journal-article>Analysis of journal article</a></li></ol></li><li><a href=#synthesis>Synthesis</a><ol><li><a href=#discussion-of-journal-article>Discussion of journal article</a></li><li><a href=#example>Example</a></li></ol></li><li><a href=#bayes-theorem>Bayes&rsquo; Theorem</a></li><li><a href=#discussion>Discussion</a></li></ol></nav></div></section><script>document.getElementById("toc-toggle").addEventListener("click",function(){var e=document.getElementById("toc-content");e.style.display==="none"?e.style.display="block":e.style.display="none"})</script></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/deep-dive/>Deep-Dive
</a><a href=/categories/data-science/>Data-Science</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/bayesian-look-at-rapid-tests/>Bayesian look at rapid tests</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Aug 02, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>23 minute read</time></div></footer></div></header><section class=article-content><p>In this post, we explore Bayesian probabilities through the lens of the accuracies of medical tests. We show how Bayesian priors can
help refine our projections, and how to do this accurately.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>This post is for a mathematical discussion, not a medical discussion. The intent is to inform the reader about how
probability works in relation to tests that can have false positives/negatives. The author has no medical training nor
is this post intended to provide medical advice. It is hoped that the reader will better understand likelihoods of test
results in the context of the mathematics, not make medical decisions based on this post.</div><h2 id=person-x>Person X</h2><p>Imagine Person X, who is exhibiting the beginnings of flu-like symptoms. They have heard on the news that COVID-19 is spreading locally. Person X purchases an over-the-counter COVID-19 rapid test, and they get a negative result. They are relieved that it is not COVID-19, and head off to their job. They think to themselves, <em>yes, maybe there is a small chance I&rsquo;ll give a coworker the flu, but I can&rsquo;t take a sick day unless I really need it, and this isn&rsquo;t COVID</em>.</p><p>Unfortunately, Person X isn&rsquo;t fully aware that medical tests can have false positives and false negatives, and that the over-the-counter tests tend to be somewhat less accurate than the more formal tests. The complexities of public education on these matters is far beyond the scope of this post, but if you were responsible for public health, you must make some tough choices in educating the public about the possible false negative or false positive results from testing.</p><p>On the one hand, if you push a lot of cautionary information to the public, a number of individuals will form an opinion that <em>these tests aren&rsquo;t 100% accurate so why bother</em>, and the percentage of people who will make an effort to tests themselves will likely go down. On the other hand, by <em>not</em> emphasizing the potential inaccuracies in these tests, you may get a higher participation rate from the public, but then you will also have cases such as Person X who may be spreading the illness under the impression that they are not infected due to a false-negative result.</p><p>How can we think about this carefully? This post is not medical instruction, but we can use data science tooling to help the average person better understand the complexities that public health officials face.</p><h2 id=definitions-and-grounding-in-reference>Definitions and grounding in reference</h2><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4><p>In order to keep the mathematical discussion focused, we will have the following simplified assumptions:</p><ul><li>We assume for simplicity that only one over-the-counter test is available to the public in order to keep our calculations simpler, and assume all batches are equally accurate and that it doesn&rsquo;t ever expire. We also assume that the test accuracy remain unchanged for new strains, which is also not likely.</li><li>We assume for simplicity the uniformity in PCR testing (the more accurate but slower test for COVID-19), that is, we assume every single test taken anywhere using any lab will have the same accuracy, and that no lab mistakes are made.</li><li>We will ignore the variation in human biology and assume that every single person conducts the at-home-test in exactly the same perfectly accurate way. For example, we ignore the fact that some individuals will not swab well enough, and that some individuals may be more likely to give false positives due to genetic variation in how the disease may manifest, i.e. it may be possible that some individuals are more likely to get a predominantly lower respiratory tract infection with this disease, and some individuals may be more likely to get an upper-respiratory tract infection (in which case the rapid test may be more accurate).</li></ul><p><strong>In reality, none of these assumptions hold true, and medical and public health officials have
to consider all of these complexities and many more.</strong></p></div><p>As will always be the case in Data Science, we are considering a model of our world that aligns in some ways with ours, but is far simpler by necessity.</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Tip</h4>The art of Data Science is finding a key point at which we&rsquo;ve added enough complexity to our model for it to provide actionable findings, but not so much complexity that our models are impractical to deploy and use. However, we must always remember that <strong>these findings are only guaranteed to apply accurately to the world of our model, and thus we need to be careful in applying them without caution and testing to the world we live in.</strong></div><p>With those caveats in mind, let&rsquo;s see what probability can tell us about our imagined Person X scenario.
There are three main tests to determine if someone is positive for COVID-19, all of these tests have some tradeoffs:</p><div class=table-wrapper><table><thead><tr><th><strong>Test Type</strong></th><th><strong>Pros</strong></th><th><strong>Cons</strong></th></tr></thead><tbody><tr><td><strong>Rapid Test</strong></td><td>- Quick results, often within 15-30 minutes.<br>- Non-invasive testing method.</td><td>- Lower accuracy compared to PCR, higher chance of false negatives.<br>- Less effective in detecting the virus early in infection.</td></tr><tr><td><strong>PCR</strong></td><td>- High accuracy and sensitivity.<br>- Considered the gold standard for detecting active infections.</td><td>- Results take longer, typically 1-3 days.<br>- More invasive and may require specialized facilities.</td></tr><tr><td><strong>Antibody</strong></td><td>- Can detect past infections and immune response.<br>- Useful for seroprevalence studies.</td><td>- Not very useful in detecting active infections.<br>- Takes 1-3 weeks after infection to develop detectable levels of antibodies.</td></tr></tbody></table></div><p>For all three types of tests, we can find multiple examples in the literature which have measured the accuracy of these tests, but of course, all of these studies are snapshots in time. As new strains become prevalent, the accuracy rate of, say, the Rapid Test, may drift. Additionally, given that research and data is never crystal clear, some of these studies disagree. For example, a study published in BMJ in 2022 found a substantially higher false positive rates with rapid testing than prior studies (Mulchandani et al)<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> had found. Data is rarely clean, there is rarely a solid answer to questions we have to ask about our models, and so we sometimes have to make careful judgment calls on what data we should include or not.</p><div class="alert alert-warning" role=alert><h4 class=alert-heading>Warning</h4>We are using a single study here to ground our discussion in numbers. In no way should this single study be seen as the final source of truth, nor should the reader take numbers presented from this study as accurately applying to all tests. The reader is encouraged to conduct further research if they wish to be a part of any debates on the accuracy of these tests and how to present accuracy data to the public.</div><p>The results summary in this journal article are informative to our discussion. We can very clearly see here why these fine probabilistic details aren&rsquo;t part of public-health&rsquo;s general public messaging. We will include as an exercise at the end of this chapter a request that the reader attempt to fashion a public-health message under the assumption that these findings are correct and replicated, which could in fact include a choice to not mention them at all. Their results summary reads (Mulchandani et al)<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><blockquote><p>Test result bands were often weak, with positive/negative discordance by three trained laboratory staff for 3.9% of devices. Using consensus readings, for known positive and negative samples sensitivity was 92.5% (95% confidence interval 88.8% to 95.1%) and specificity was 97.9% (97.2% to 98.4%). Using an immunoassay reference standard, sensitivity was 94.2% (90.7% to 96.5%) among PCR confirmed cases but 84.7% (80.6% to 88.1%) among other people with antibodies. This is consistent with AbC-19 being more sensitive when antibody concentrations are higher, as people with PCR confirmation tended to have more severe disease whereas only 62% (218/354) of seropositive participants had had symptoms. If 1 million key workers were tested with AbC-19 and 10% had actually been previously infected, 84,700 true positive and 18,900 false positive results would be projected. The probability that a positive result was correct would be 81.7% (76.8% to 85.8%).</p></blockquote><p>In the next section, we&rsquo;ll take a deeper dive into what this results summary may mean.</p><h3 id=definitions>Definitions</h3><h4 id=test-results>Test results</h4><p>First, let&rsquo;s define some of the words used here that may be unfamiliar to those starting off in data science.</p><div class=td-content style=text-align:center><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>flowchart TD
</span></span><span class=line><span class=cl>    A[Test Result] --&gt;|+| B[Positive]
</span></span><span class=line><span class=cl>    A --&gt;|- | C[Negative]
</span></span><span class=line><span class=cl>    B --&gt;|Reality: Infected| D[True Positive]
</span></span><span class=line><span class=cl>    B --&gt;|Reality: Not Infected| E[False Positive]
</span></span><span class=line><span class=cl>    C --&gt;|Reality: Not Infected| F[True Negative]
</span></span><span class=line><span class=cl>    C --&gt;|Reality: Infected| G[False Negative]
</span></span></code></pre></td></tr></table></div></div></div><div class="alert alert-primary" role=alert><h4 class=alert-heading>True/False Positive/Negative</h4><p>We will define these in the context of our current discussion about epidemiology.
Suppose a test can have two results: positive or negative. Suppose that these results map with some accuracy to a corresponding state, such as infected or not-infected. Then we can define the following terms:</p><ul><li><p><strong>True Positive (TP)</strong>: When a test result is positive, and the reality is that the person <strong>is</strong> indeed infected.</p></li><li><p><strong>False Positive (FP)</strong>: When a test result is positive, and the reality is that the person is <strong>NOT</strong> infected.</p></li><li><p><strong>True Negative (TN)</strong>: When a test result is negative, and the reality is that the person is <strong>NOT</strong> infected.</p></li><li><p><strong>False Negative (FN)</strong>: When a test result is negative, and the reality is that the person <strong>is</strong> indeed infected.</p></li></ul></div><h4 id=conditional-probability>Conditional Probability</h4><p>Suppose we wish to find out the probability that someone is actually infected when they have tested negative.</p><p>Conditional probability is defined as:</p><div class=td-content><div class=inner-wrapper><div class=venn-container><div id=venn class=venn-diagram></div><div class=equation>$$ A \cap B = \{x \in \mathcal{U} \mid x \in A \text{ and } x \in B\}$$
$$ P(B|A) = \frac{P(A \cap B)}{P(A)}$$</div></div></div></div><script src=/js/d3.v4.min.js></script><script src=/js/venn.js></script><script>var sets=[{sets:["A"],size:12},{sets:["B"],size:12},{sets:["A","B"],size:4,label:"A ∩ B"}],chart=venn.VennDiagram().wrap(!1).width(250).height(250),div=d3.select("#venn").datum(sets).call(chart);div.selectAll("text").style("fill","white"),div.selectAll(".venn-circle path").style("fill-opacity",.6)</script><style>.inner-wrapper{display:flex;justify-content:center;align-items:center;width:75%;box-sizing:border-box}.venn-container{display:flex;justify-content:center;align-items:center;width:100%;box-sizing:border-box;flex-wrap:wrap}.venn-diagram{flex:initial;max-width:250px;box-sizing:border-box}.equation{flex:initial;text-align:center;margin-left:20px;box-sizing:border-box}@media(max-width:768px){.venn-container{flex-direction:column}.equation{margin-left:0;margin-top:20px}}</style><ul><li><p>Consider a sample of two people whom we can definitively divide into a group whose test result was <em>negative</em> (group A) and those who were actually <em>positive</em> (group B). The group A might be those whose rapid test claimed negative, the group B might be those whose antibody test later showed they were actually infected.</p></li><li><p>\(A \cap B\) is the intersection of group A with group B, that is, people who belong to both groups&ndash;people whose rapid test said negative but were actually positive, i.e. the False Negative group.</p></li><li><p>\(P(B | A)\) is the mathematical way of stating the probability of being in group B (infected) <em>given</em> that one is <em>also</em> in group A (tests negative).</p></li><li><p>We define \(P(B | A)\) as the ratio \(P(B \cap A)\) over \(P(A)\)</p></li><li><p>Hence, intuitively, the probability that of any randomly selected person in group A (test negative) are also in the pool B (is infected) is equal to the portion of people \(A \cap B\) that overlaps with the entire pool A.</p></li><li><p>This assumes a very large ensemble of people selected to study in either group, this doesn&rsquo;t work reliable for smaller sample sizes.</p></li></ul><h4 id=sensitivity-specificity-and-accuracy>Sensitivity, Specificity, and Accuracy</h4><p>We now present some standard definitions:</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Sensitivity</h4><p>Portion of test results which gave a true positive result out of the pool of all test subjects who were in fact infected (those who were infected and got an accurate positive result are TP, those who were infected but got a negative result were FN, the sum TP + FN gives us the total that was in fact infected). The probability is written as the probability of getting a positive result \(P(+)\) given &ldquo;|&rdquo; that they are indeed infected \(P(D)\):</p><p>$$ P(+|D) = \frac{\text{TP}}{\text{TP} + \text{FN}} $$</p></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Specificity</h4><p>Portion of test results which gave a true negative result out of the pool of all test subjects who were in fact <strong>NOT</strong> infected (those who were <strong>NOT</strong> infected and got a positive result are FP, those who were <strong>NOT</strong> infected and got an accurate negative result were TN, the sum TN + FP gives us the total that was in fact <strong>NOT</strong> infected). The probability is written as the probability of getting an negative result \(P(-)\) given &ldquo;|&rdquo; that they are not infected \(P(\neg D)\):</p><p>$$ P(-|\neg D) = \frac{\text{TN}}{\text{TN} + \text{FP}} $$</p></div><div class="alert alert-info" role=alert><h4 class=alert-heading>Accuracy</h4>Portion of all test results that were correctly identified, either as positive or negative, out of the total number of tests conducted. This includes both true positive results (TP, those who were infected and got an accurate positive result) and true negative results (TN, those who were <strong>NOT</strong> infected and got an accurate negative result), divided by the total number of tests, which is the sum of true positives (TP), false positives (FP, those who were <strong>NOT</strong> infected but got a positive result), true negatives (TN), and false negatives (FN, those who were infected but got a negative result).
$$ \frac{\text{TP} + \text{TN}}{\text{TP} + \text{TN} + \text{FP} + \text{FN}} $$</div><div class="alert alert-primary" role=alert><h4 class=alert-heading>Remark</h4><p>In what follows, we will be treating this equation and other like it as if this equivalence were true:</p><p>$$ \text{Specificity} = P(\text{TN}|\neg D) = P(-|\neg D) $$</p><p>In the context of disease as we are discussing it here, this equivalence is valid. Please note, though, that for more complicated discussions on probability, this equivalence may not hold.</p></div><h3 id=analysis-of-journal-article>Analysis of journal article</h3><p>Given the above definitions, we can examine this statement of the results from our example reference (Mulchandani et al)<sup id=fnref2:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><blockquote><p>Using consensus readings, for known positive and negative samples sensitivity was 92.5% (95% confidence interval 88.8% to 95.1%) and specificity was 97.9% (97.2% to 98.4%).</p></blockquote><p>By consensus readings, the protocol they describe entailed having three readers evaluate each test (Mulchandani et al)<sup id=fnref3:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><blockquote><p>If the three independent readers disagreed on the positivity of a sample, the majority reading was taken as the “overall” or consensus test result in our primary analysis, as per the WHO protocol.</p></blockquote><p>To determine who was true positive, the researchers used the baseline of truth for this consensus reading analysis to be &ldquo;participants who had had a positive PCR test for SARS-CoV-2&rsquo;&rsquo; (Mulchandani et al)<sup id=fnref4:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. The PCR test, while more accurate than a rapid test, itself lacks perfect accuracy, so this and other systematic potential errors results in a uncertainty interval. Here&rsquo;s a quick summary of their sensitivity findings:</p><div class="alert alert-info" role=alert><h4 class=alert-heading>Summary of findings</h4><ul><li><em>Rapid Test Sensitivity</em> when baseline for true positives was self-reported PCR positives alone: ≈92.5%</li><li><em>Rapid Test Sensitivity</em> for those who had confirmed PCR positives when baseline for true positives was antibody blood test: ≈94.2%</li><li><em>Rapid Test Sensitivity</em> for those who had no PCR test and hence had an unknown infection status, when baseline for true positives was antibody blood test: ≈84.7%</li></ul></div><p>So what&rsquo;s happening here? One explanation the researchers propose is that those individuals who had a more intense infection were more likely to experience more intense symptoms and more likely to get a PCR test. And since Rapid Tests are shown to be more accurate for those with more intense symptoms, and having more intense symptoms makes getting a PCR more likely (due to the inconvenience and discomfort of these tests as compared to Rapid Tests, those with fewer or less intense symptoms are less likely to make the effort), it then makes sense that these tests have higher sensitivity for those who got the PCR test. In the words of authors (Mulchandani et al)<sup id=fnref5:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><blockquote><p>This is consistent with AbC-19 being more sensitive when antibody concentrations are higher, as people with PCR confirmation tended to have more severe disease whereas only 62% (218/354) of seropositive participants had had symptoms.</p></blockquote><p>That is, of their sample group with whom they were certain had been positive due to the seropositive (anti-body blood test), only 62% had
displayed symptoms. That leaves a large group of people who might have shown no symptoms and did not know they were exposed, and those who had no symptoms, knew they were exposed, but either didn&rsquo;t bother getting tested due to lack of symptoms or simply took a rapid test.</p><h2 id=synthesis>Synthesis</h2><p>Let&rsquo;s imagine for a moment the unenviable task of being in charge of public health messaging. How might you relate the prior discussion to the general public? (Please note, in reality you would want to synthesize many journal articles that replicate each other, but when there is a new virus on the scene, often one has to work with just the first to publish and decide whether or not to act on that information before replication is achieved by other labs).</p><p>We can look at how some of this information was handled at the time. One example dated from August 2020 (well before the above journal article was published) was that the US FDA advised at the time that rapid test should not be given to people <em>without</em> symptoms (Mulchandani et al)<sup id=fnref6:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>:</p><blockquote><p>People without symptoms of COVID-19 who haven’t been exposed to the virus shouldn’t get rapid tests to see if they are infected, according to guidance Friday from the Food and Drug Administration.</p></blockquote><blockquote><p>The guidance, added to the agency’s website, says that instead, highly sensitive tests, known as PCR tests, should be used for such individuals — if turnaround times are fast enough. These lab-based tests are known to be more accurate, but take hours to complete. Recent backlogs across the country have left some people waiting upward of 10 days for results.</p></blockquote><p>At the time, rapid tests were approximately the same cost as PCR tests. From the University of Chicago News we can find a more recent recommendation from Assoc. Prof. Emily Landon \cite{UChicagoNews2020RapidCOVIDTest}:</p><blockquote><p>Rapid antigen tests – which you can buy in most pharmacies, big box stores and online retailers, are an excellent choice – but you may need to take multiple tests. Rapid antigen tests detect COVID-19 when people have a higher amount of virus particles in their system and are more contagious. But a negative antigen test doesn’t necessarily mean you don’t have COVID-19. Trust a positive antigen test, but be more skeptical about a negative one.</p></blockquote><h3 id=discussion-of-journal-article>Discussion of journal article</h3><p>We agree with the journal authors that it is advisable to &ldquo;trust a positive [rapid test]&rdquo;, even though the sensitivity has been found to be potentially as low as 84.7% for the test in question at the time of testing. We can argue from a public good perspective that this is an excellent example of public health messaging:</p><ul><li>Firstly, we have to accept that the scientific education of the general public is on a spectrum, and that the vast majority of the public lacks scientific education beyond what was provided in public schooling. This is not to sound elitist, but we have to understand our audience and what an audience may <em>hear</em> from their perspective.</li><li>If enough of the public starts to think that because of their imperfections, the rapid tests aren&rsquo;t worth taking, then a powerful tool for slowing the spread of infection is reduced.</li><li>For those who might have a non-Covid infection, such as a cold, and test positive with the rapid test, the likely worst outcome of the false positive is that they take extra precautions to not spread their infection.</li><li>On the other hand, if they were actually positive and dismiss the test&rsquo;s positive results, they could potentially infect individuals who are vulnerable to severe disease, or at least be more likely to spread the disease than otherwise.</li></ul><p>So instead of saying to the public: &ldquo;If you test positive with a rapid test, you have an approximately 90% chance or so that you actually have COVID-19,&rdquo; a simple straight-forward message to &ldquo;trust the positive result&rdquo; likely maximizes the public good.</p><p>On the other hand, although the specificity (portion of negatives that are true negatives) for these tests is fairly high, this is partially due to the fact that in the pool of test subjects, the vast majority of the subjects will not have COVID-19, and since the total number of False Positives will be small portion of the already relatively small number of positives, True Negatives will dominate the specificity equation; or to think about it in terms of limits:</p><p>$$ \lim_{TN \rightarrow \infty} \frac{TN}{TN + FP} = 1 $$</p><p>Things bring us to an important remark:</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Remark</h4><p>When evaluating the values of sensitivity and specificity, be mindful of the proportions of the pool being analyzed. For example, if a test is administered to a population of 1000 where only one single person is infected, and the test captures that positive and also gives a single false positive, then specificity becomes:
$$ P(-|\neg D) = \frac{\text{TN}}{\text{TN} + \text{FP}} = \frac{999}{998 + 1} = 1$$
That is, everyone who was negative was measured to by the test, but the sample size is so small that this measure is unlikely to be a reliable projection for a larger population.</p><p>Similarly, sensitivity becomes:
$$ P(+|D) = \frac{\text{TP}}{\text{TP} + \text{FN}} = \frac{1}{1 + 0 } = 1 $$
However, these numbers are practically worthless because the sample set was so heavily unbalanced and there isn&rsquo;t enough subjects to form a clear statistical picture.</p><p>Neither of these measures reflect that we had a single false positive, although accuracy would:</p><p>$$ \frac{\text{TP} + \text{TN}}{\text{TP} + \text{TN} + \text{FP} + \text{FN}} = \frac{1 + 998}{1 + 998 + 1 + 0} = 0.999 $$</p><p>But again, given the small sample size, these numbers are not likely to hold up upon replication with a larger sample size.
Statistics is about forming conclusions based on incomplete data, but there is a limit at which data is too incomplete to draw
conclusions. How that limit is determined is beyond the scope of this post.</p></div><p>However, in the study cited, and a multitude of other studies, the results are statistically significant enough that we can, with some confidence, examine real world scenarios with the context of these findings. Let&rsquo;s return to our case of Person X and examine their situation given these numbers and assumptions above.</p><h3 id=example>Example</h3><div class="alert alert-secondary" role=alert><h4 class=alert-heading>Example</h4><blockquote><p>Suppose the Person X we started this post with, who has symptoms consistent with cold/flu/COVID-19, took a rapid test and got a negative result. What are the chances that Person X got a false negative and is indeed infected with SARS-COV-2?</p></blockquote><p>In the following discussion, D is short for disease, such that \( P(D) \) is the probability that someone who exhibits certain symptoms has the disease in question, in this case, COVID-19, vs having some other disease \(P(D&rsquo;)\), say, a flu.</p><p>Given the following assumptions and definitions:</p><ul><li>Prevalence Rate of COVID-19 in the population of those currently exhibiting cold and flu symptoms (Prior Probability, P(D)): 35%. This means that of all the people displaying cold and flu symptoms, 35% will have COVID-19, the remainder will have some other virus. I&rsquo;ve randomly selected the number 35% for the sake of this example, in reality this number will vary by region and current viral trends. It is also impossible to determine this number precisely since a number of individuals who are showing such symptoms do not get sick enough to enter the medical system for testing, and for many viruses people might get effected and have minimal or no symptoms (asymptomatic) and be missed entirely.</li><li>Sensitivity (True Positive Rate, P(+|D), the probability of getting a positive result given that the person does have the disease): 84.7%.</li><li>Specificity (True Negative Rate, P(-|¬D), the probability of getting a negative result given that the individual does not have the disease): 97.9%.</li><li>\(P(-|D)\): The probability of getting a false negative result given that the individual does have the disease (1-sensitivity).</li><li>\(P(D|-)\): The probability of the tested individual to have the disease given a negative test.</li></ul><p>Let&rsquo;s start by calculating \(P(-)\), the probability of any member of the subject population receiving a negative test result from the rapid test (without knowing whether they have the disease or not). There are two probabilistic pathways for them to fall into this group. The first is that they don&rsquo;t have the disease and get a True Negative result from the test. The other pathway is that they have the disease but get a False Negative.</p><div class=td-content style=text-align:center><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>graph TD
</span></span><span class=line><span class=cl>    Population --&gt; |&#34;P(D)&#34;| D[&#34;Has Disease (D)&#34;]
</span></span><span class=line><span class=cl>    Population --&gt; |&#34;P(¬D)&#34;| ND[&#34;No Disease (¬D)&#34;]
</span></span><span class=line><span class=cl>    D --&gt; |&#34;P(-|D): 1-Sensitivity&#34;| FN[&#34;False Negative&#34;]
</span></span><span class=line><span class=cl>    ND --&gt; |&#34;P(-|¬D): Specificity&#34;| TN[&#34;True Negative&#34;]
</span></span><span class=line><span class=cl>    FN --&gt; |&#34;P(D) · P(-|D)&#34;| N[&#34;Negative Result P(-)&#34;]
</span></span><span class=line><span class=cl>    TN --&gt; |&#34;P(¬D) · P(-|¬D)&#34;| N
</span></span></code></pre></td></tr></table></div></div></div><p>The probability of getting a negative result is thus
the sum of the probability of having the disease but getting a false negative given that one has the disease,
\(P(D) \cdot P(-|D)\), plus the probability of not having the disease
and getting a true negative result given that one does not have the disease, \(P(\neg D) · P(-|\neg D)\).</p><p>This gives us the equation</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>\begin{aligned}
</span></span><span class=line><span class=cl>P(-) &amp;=&amp; P(\neg D) \cdot P(-|\neg D) + P(D) \cdot P(-|D) \\
</span></span><span class=line><span class=cl> &amp;=&amp; \left(1 - P(D)\right) \cdot P(-|\neg D) + P(D) \cdot \left(1 - P(+|D)\right)\\
</span></span><span class=line><span class=cl>&amp;=&amp; (1-0.35)(0.979) + (0.35)(1-0.847) \\
</span></span><span class=line><span class=cl>&amp;=&amp; 0.6899
</span></span><span class=line><span class=cl>\end{aligned}
</span></span></code></pre></td></tr></table></div></div><p>So for our Person X, we would like to know: <strong>given a negative test</strong>, what is the probability that they actually <strong>do</strong> have COVID-19? That is, we would like to estimate \(P(D|-)\). By the definition of <a class=link href=#conditional-probability>conditional probabilities</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>\begin{aligned}
</span></span><span class=line><span class=cl>P(D|-) &amp;=&amp; \frac{P(D \cap -)}{P(-)} \\
</span></span><span class=line><span class=cl>&amp;=&amp; \frac{P(D)\cdot P(-|D)}{P(-)} \\
</span></span><span class=line><span class=cl>&amp;=&amp; \frac{ P(D) \cdot \left( 1 - P(+|D)\right) }{P(-)} \\
</span></span><span class=line><span class=cl>&amp;=&amp; \frac{0.35 \cdot (1-0.847)}{0.6899}\\
</span></span><span class=line><span class=cl>&amp;=&amp; 0.0776
</span></span><span class=line><span class=cl>\end{aligned}
</span></span></code></pre></td></tr></table></div></div><p>That is, in this given scenario, assuming the numbers above, the probability that Person X has the disease despite the
fact that their rapid test came back negative is around 7.76%. <strong>Important: This number is particular to the scenario we imagined above, but is in no way representative for every case. For example, we picked a random percentage for \(P(D)\). Please do not use these numbers to make real world decisions or arguments. This was for demonstrative educational purposes only.</strong></p></div><h2 id=bayes-theorem>Bayes&rsquo; Theorem</h2><p>The above equation second line in the above question is known as Bayes&rsquo; Theorem, which is generically written:</p><p>$$P(A | B)=\frac{P(A) \cdot P(B | A) }{P(B)}$$</p><h2 id=discussion>Discussion</h2><p>We can visualize the situation with a Sankey diagram. Here we exaggerate the percentage of false positives and negatives for visual purposes. As can be seen, those who are infected but obtain a negative test and then do not self-isolate join the uninfected in non-isolation allowing the virus to spread and underlining the importance of accurate tests. However, the test results are accurate enough to catch the majority
of people who are genuinely infected, and hence, reduces the rate of spread.</p><p><img src=/p/bayesian-look-at-rapid-tests/image.png width=709 height=275 srcset="/p/bayesian-look-at-rapid-tests/image_hu1798480561541634851.png 480w, /p/bayesian-look-at-rapid-tests/image_hu1158743544528413052.png 1024w" loading=lazy alt="This type of diagram is called a Sankey diagram. Here we exaggerate the percentage of false positives and negatives for visual purposes. As can be seen, those who are infected but obtain a negative test and then do not self-isolate join the uninfected in non-isolation allowing the virus to spread and underlining the importance of accurate tests." class=gallery-image data-flex-grow=257 data-flex-basis=618px></p><ul><li><p>This Bayesian analysis demonstrates that, under the given assumptions, an individual with symptoms who tests negative with a rapid COVID-19 test sometimes has a low but non-trivial probability of being actually positive for the virus.</p></li><li><p>However, diseases aren&rsquo;t just the story of an individual, they are fully stories of an ensemble of individuals.</p></li><li><p>So instead of saying that in this imagined scenario, Person X has a 7.76% chance of actually having COVID-19 despite the negative rapid test, we would more accurately have summarized it as follows:</p><ul><li><em>Given these (guessed) assumptions, including the test accuracy rates and prevalence of COVID-19 among those exhibiting flu or cold like symptoms, on average 7 to 8 out of every 100 people chosen from the wider population who have symptoms of a respiratory illness but test negative with this rapid test will in fact be positive and potentially capable of spreading the disease.</em> (<strong>Again, please note that these numbers are not to be used in the real world, this is meant to demonstrate a first pass at calculating these probabilities.</strong>)</li></ul></li><li><p>Hence we see the public health messaging challenges for scenarios such as this, where we need to underline the imperfections of the test in order to instill some caution in the public regarding negative tests results, while maintaining public trust in the positive results so that the population continues to take them seriously and self-isolate.</p></li><li><p>Ultimately, the work of public health comes down to <strong>minimizing</strong> the total number of deaths balanced against the negative impacts of public health mitigation efforts. It is a tough job, but one that benefits from public communications that are straight-forward to understand by the general population.</p></li><li><p>Understanding how these probabilities are calculated can help individuals spot misinformation.</p></li></ul><p>It is a tough job, with no easy answers, and as is typical in statistics, there is never any perfect certainty. Accepting that this is true for almost every decision that must be made in human societies doesn&rsquo;t mean we just give up and let what happens happen. It means we do our very best with the limited information we have, and constantly refine our approach as more information is obtained.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Mulchandani et al., <em>Accuracy of UK Rapid Test Consortium (UK-RTC) AbC-19 Rapid Test for detection of previous SARS-CoV-2 infection in key workers: test accuracy study</em>, BMJ, 371, 2020, doi <a class=link href=https://www.bmj.com/content/371/bmj.m4262 target=_blank rel=noopener>10.1136/bmj.m4262</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref2:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref3:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref4:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref5:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref6:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></section><footer class=article-footer><section class=article-tags><a href=/tags/math/>Math</a>
<a href=/tags/statistics/>Statistics</a>
<a href=/tags/bayesian/>Bayesian</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/automating-the-circularization-of-apollo-in-kerbal-with-python-krpc-and-physics/><div class=article-details><h2 class=article-title>Automating the circularization of Apollo in Kerbal with python, KRPC, and Physics</h2></div></a></article><article><a href=/p/devops-101-chef-cookbook-with-testing/><div class=article-details><h2 class=article-title>DevOps 101: Chef Cookbook with Testing</h2></div></a></article><article><a href=/p/python-uses-operational-chaining-for-boolean-comparisons/><div class=article-details><h2 class=article-title>Python Uses Operational Chaining for Boolean Comparisons</h2></div></a></article><article><a href=/p/abstracting-networking-with-docker-containers/><div class=article-details><h2 class=article-title>Abstracting Networking with Docker Containers</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2024</section><section class=powerby>You are a wonderful manifestation of the evolution of the universe.<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> / Theme --> <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>